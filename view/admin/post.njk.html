{% extends "admin/layout.njk.html" %}

{% block title %}
  Post
{% endblock %}

{% block content %}
<h1>This is Post Page Manager</h1>
<div class="col-md-8 mx-auto mt-5">
    <div class="row tex">
        <div class="col-md-8 float left">
          <a href="/addpost" class="btn btn-primary"> Add Post + </a>
          <a href="" class="btn btn-primary">View all</a>
        </div>
      </div>
<table class="table">
  <thead>
      <tr>
          <th>Id Post</th>
          <th>Title Post</th>
          <th>Category</th>
          <th>View</th>
          <th>Ngay dang</th>
          <th colspan="2" width="3%" class="text-center">Action</th>
      </tr>
  </thead>
  <tbody>
      {% for item in posts %}
      <tr id="row{{ item.id }}">
        <td>{{ item.id }}</td>
        <td>{{ item.title }}</td>
        <td>{{ item.category }}</td>
        <td>{{ item.view }}</td>
        <td>{{ item.created_at.toDateString() }}</td>
        <td>
          <a href="/admin/editpost?id={{ item.id }}" class="btn btn-info" >Edit</a>
        </td>
        <td>
          <button class="btn btn-danger btnDelete" id="{{ item.id }}">Delete</button>
        </td>
      </tr>
      {% endfor %}
  </tbody>
</table>
</div>
{% endblock %}
{% block bottom %}
<script type="text/javascript">
$(function (){
    $('.btnDelete').click(function() {
      let click = $(this);
      let idPost = click.attr( "id" );
					$.ajax({
						url: "/admin/deletepost",
						data: { id:idPost },
            type: 'POST',
						success: function(result){
              if (result) {
                alert("success");
                $('#row'+idPost).hide();
              }else{
                alert('fail');
              }
              
						}
					});
			});
  })
</script>
{% endblock %}